# Agent å†³ç­–ç³»ç»Ÿå¯¹æ¯”ï¼šå½“å‰å®ç° vs LLM å®ç°

## ğŸ“Š å½“å‰å®ç°ï¼šåŸºäºè§„åˆ™çš„ç­–ç•¥ (Rule-based)

### æ¶æ„
```
World State â†’ Policy Function â†’ Action
   â†“              â†“
æ„ŸçŸ¥ç¯å¢ƒ      æ‰‹å†™è§„åˆ™åˆ¤æ–­    è¿”å›åŠ¨ä½œå­—ç¬¦ä¸²
```

### ä»£ç ç¤ºä¾‹
```python
def policy_gatherer(agent, world):
    # æ‰‹å†™çš„if-elseè§„åˆ™
    if agent.carry_food > 0:
        return "è¿”å›å®¶å›­"
    
    # è®¡ç®—æ¯ä¸ªæ–¹å‘çš„å¾—åˆ†
    best_score = -1
    best_action = "F"
    for direction in ["F", "TL", "TR"]:
        score = calculate_score(direction)  # æ•°å­¦å…¬å¼
        if score > best_score:
            best_action = direction
    
    return best_action
```

### ç‰¹ç‚¹
- âœ… **é€Ÿåº¦å¿«**ï¼šæ¯«ç§’çº§å†³ç­–
- âœ… **å¯é¢„æµ‹**ï¼šè¡Œä¸ºå®Œå…¨ç¡®å®š
- âœ… **ä½æˆæœ¬**ï¼šæ— éœ€ API è°ƒç”¨
- âœ… **å¯è°ƒè¯•**ï¼šé€»è¾‘æ¸…æ™°
- âŒ **çµæ´»æ€§ä½**ï¼šéœ€è¦æ‰‹å†™æ‰€æœ‰è§„åˆ™
- âŒ **éš¾ä»¥æ³›åŒ–**ï¼šæ–°æƒ…å†µéœ€è¦æ–°è§„åˆ™

---

## ğŸ¤– å¦‚æœç”¨ LLM å®ç°

### æ¶æ„
```
World State â†’ LLM Prompt â†’ Parse Response â†’ Action
   â†“            â†“              â†“
è§‚å¯Ÿæè¿°    è‡ªç„¶è¯­è¨€ç†è§£   æå–åŠ¨ä½œ
```

### å¯èƒ½çš„å®ç°
```python
def policy_llm(agent, world):
    # 1. æ„é€ è§‚å¯Ÿæè¿°
    observation = f"""
    ä½ æ˜¯ä¸€ä¸ª {'æ¢ç´¢è€…' if agent.role == 'Explorer' else 'é‡‡é›†è€…'}
    å½“å‰çŠ¶æ€:
    - ä½ç½®: ({agent.x}, {agent.y})
    - èƒ½é‡: {agent.energy}
    - æºå¸¦é£Ÿç‰©: {agent.carry_food}
    - å‰æ–¹: {world.layers['FOOD'][agent.front_y, agent.front_x]} é£Ÿç‰©
    - å·¦ä¾§: ...
    - å³ä¾§: ...
    
    å¯é€‰åŠ¨ä½œ: å‰è¿›(F), å·¦è½¬(TL), å³è½¬(TR), é‡‡é›†(PICK), æ”¾ä¸‹(DROP)
    
    è¯·é€‰æ‹©æœ€ä½³åŠ¨ä½œ:
    """
    
    # 2. è°ƒç”¨ LLM
    response = llm_call(observation)
    
    # 3. è§£æå“åº”
    action = parse_action(response)  # "F" / "TL" / etc
    
    return action
```

### ç‰¹ç‚¹
- âœ… **çµæ´»æ€§å¼º**ï¼šå¯ä»¥ç†è§£å¤æ‚æƒ…å†µ
- âœ… **æ˜“äºæ‰©å±•**ï¼šç”¨è‡ªç„¶è¯­è¨€æè¿°æ–°è§„åˆ™
- âœ… **å¯èƒ½æ¶Œç°æ–°ç­–ç•¥**ï¼šLLM å¯èƒ½å‘ç°æ„å¤–çš„å¥½ç­–ç•¥
- âŒ **é€Ÿåº¦æ…¢**ï¼šæ¯ä¸ªå†³ç­–éœ€è¦å‡ ç™¾æ¯«ç§’åˆ°å‡ ç§’
- âŒ **æˆæœ¬é«˜**ï¼š25ä¸ªagent Ã— æ¯ç§’1æ¬¡å†³ç­– = å¤§é‡ API è°ƒç”¨
- âŒ **ä¸ç¨³å®š**ï¼šè¾“å‡ºå¯èƒ½ä¸ä¸€è‡´
- âŒ **éš¾ä»¥è®­ç»ƒ**ï¼šæ— æ³•ç›´æ¥ç”¨è¿›åŒ–ç®—æ³•ä¼˜åŒ–

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### å½“å‰å®ç°ï¼ˆè§„åˆ™ï¼‰
- **å†³ç­–é€Ÿåº¦**: ~0.01ms / agent
- **25ä¸ªagents**: 0.25ms total
- **æˆæœ¬**: $0
- **å¯ä»¥å®æ—¶è¿è¡Œ**: âœ…

### LLM å®ç°ï¼ˆå‡è®¾ï¼‰
- **å†³ç­–é€Ÿåº¦**: ~200ms / agent (GPT-4)
- **25ä¸ªagents**: 5000ms = 5ç§’ total
- **æˆæœ¬**: ~$0.01 / 1000 decisions
- **å®æ—¶è¿è¡Œ**: âŒ å¤ªæ…¢

---

## ğŸ¯ æ··åˆæ–¹æ¡ˆ

ä¸€ä¸ªå¯è¡Œçš„ä¸­é—´æ–¹æ¡ˆæ˜¯ **LLM ä½œä¸ºé«˜å±‚è§„åˆ’å™¨**ï¼š

```python
# ä½é¢‘ï¼šLLM åˆ¶å®šç­–ç•¥
def llm_strategy_planner(agent, world):
    # æ¯ 100 æ­¥è°ƒç”¨ä¸€æ¬¡ LLM
    if agent.age % 100 == 0:
        strategy = llm_call(f"""
        åˆ†æå½“å‰æƒ…å†µï¼Œåˆ¶å®šæ¥ä¸‹æ¥çš„ç­–ç•¥ï¼š
        - å‘¨å›´é£Ÿç‰©åˆ†å¸ƒ: {get_food_map()}
        - å›¢é˜ŸçŠ¶æ€: {get_team_stats()}
        
        å»ºè®®æ¥ä¸‹æ¥ï¼š
        1. æ¢ç´¢åŒ—æ–¹
        2. åœ¨ä¸œå—æ–¹å‘é‡‡é›†
        3. ...
        """)
        agent.current_strategy = parse_strategy(strategy)
    
    # é«˜é¢‘ï¼šè§„åˆ™æ‰§è¡Œç­–ç•¥
    return execute_strategy(agent.current_strategy)
```

---

## ğŸ’¡ æ€»ç»“

### å½“å‰ç³»ç»Ÿï¼š
- **ç±»å‹**: è¿›åŒ–ç®—æ³• + åŸºå› ç¼–ç çš„ç­–ç•¥
- **å†³ç­–**: æ‰‹å†™è§„åˆ™ + æ•°å€¼è¯„åˆ†
- **å­¦ä¹ **: é€šè¿‡ç¹æ®–å’Œå˜å¼‚ä¼˜åŒ–åŸºå› 
- **ç±»æ¯”**: ç±»ä¼¼æ˜†è™«çš„æœ¬èƒ½è¡Œä¸º

### LLM Agent ç³»ç»Ÿï¼š
- **ç±»å‹**: å¤§è¯­è¨€æ¨¡å‹é©±åŠ¨
- **å†³ç­–**: è‡ªç„¶è¯­è¨€ç†è§£å’Œæ¨ç†
- **å­¦ä¹ **: å¯èƒ½éœ€è¦ fine-tuning æˆ– prompt engineering
- **ç±»æ¯”**: ç±»ä¼¼äººç±»çš„æ¨ç†å†³ç­–

---

## ğŸš€ å¦‚æœä½ æƒ³å°è¯• LLM Agent

æˆ‘å¯ä»¥å¸®ä½ å®ç°ä¸€ä¸ª **LLM é©±åŠ¨çš„å•ä¸ª agent** ä½œä¸ºå¯¹æ¯”å®éªŒï¼š

```python
# ä¼ªä»£ç 
class LLMAgent:
    def decide_action(self, observation):
        prompt = self.build_prompt(observation)
        response = openai.chat.completions.create(
            model="gpt-4o-mini",  # æ›´å¿«æ›´ä¾¿å®œ
            messages=[
                {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½é‡‡é›†ä»£ç†..."},
                {"role": "user", "content": prompt}
            ],
            temperature=0.3
        )
        return self.parse_action(response)
```

ä½†è¿™éœ€è¦ï¼š
1. OpenAI API key
2. æ¥å—è¾ƒæ…¢çš„è¿è¡Œé€Ÿåº¦
3. API è°ƒç”¨æˆæœ¬

---

æƒ³è¦æˆ‘å®ç°ä¸€ä¸ª LLM Agent çš„ç¤ºä¾‹å—ï¼Ÿæˆ–è€…ç»§ç»­ä¼˜åŒ–å½“å‰çš„è§„åˆ™ç³»ç»Ÿï¼Ÿ
